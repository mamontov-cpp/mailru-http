Реализация взята с http://www.codeproject.com/Articles/157001/Full-getopt-Port-for-Unicode-and-Multibyte-Microso
чтобы не выкатывать велосипеды для такой простой задачи.

Это используется только по Win32, где нет нормальной поддержки getopt.